<!DOCTYPE html>
<html>
<head>
  <title>Demo : GCM for Chrome</title>
  <link rel="manifest" href="./manifest.json">
</head>
<body>
<header>
  <h1>Demo : GCM for Chrome</h1>
</header>
<script src="../bin/GCMClientImpl.js"></script>
<script type="text/javascript">
var client = new GCMClientImpl();
window.addEventListener('load', function () {
  if (!client.isServiceWorkerEnabled()) {
    console.log('Service worker is disabled...');
    return;
  }
  if (!client.isNotificationEnabled()) {
    console.log('Notification is disabled...');
    return;
  }
  navigator.serviceWorker.register('/service-worker.js')  
    .then(initialiseState);  
});

function initialiseState() {
  client.getSubscription({
    success : function(token) {
      console.log('push token = ' + token);
    },
    error : function(err) {
      console.log('failed to subscribe ' + err);
    }
  });
}
</script>
</body>
</html>
